<!DOCTYPE html>
<html style="font-size: 16px;">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">
    <meta name="keywords" content="CS194 Project4:&nbsp;Facial Keypoint Detection with Neural Networks">
    <meta name="description" content="">
    <meta name="page_type" content="np-template-header-footer-from-plugin">
    <title>2 Full Facial</title>
    <link rel="stylesheet" href="nicepage.css" media="screen">
<link rel="stylesheet" href="2-Full-Facial.css" media="screen">
    <script class="u-script" type="text/javascript" src="jquery.js" defer=""></script>
    <script class="u-script" type="text/javascript" src="nicepage.js" defer=""></script>
    <meta name="generator" content="Nicepage 2.27.1, nicepage.com">
    <link id="u-theme-google-font" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:100,100i,300,300i,400,400i,500,500i,700,700i,900,900i|Open+Sans:300,300i,400,400i,600,600i,700,700i,800,800i">
    
    
    <script type="application/ld+json">{
		"@context": "http://schema.org",
		"@type": "Organization",
		"name": "",
		"url": "index.html"
}</script>
    <meta property="og:title" content="2 Full Facial">
    <meta property="og:type" content="website">
    <meta name="theme-color" content="#478ac9">
    <link rel="canonical" href="index.html">
    <meta property="og:url" content="index.html">
  </head>
  <body class="u-body"><header class="u-clearfix u-header u-palette-1-light-3 u-header" id="sec-509c"><div class="u-clearfix u-sheet u-sheet-1">
        <h1 class="u-text u-text-palette-1-dark-1 u-text-1">CS194 Project4:&nbsp;<br>Facial Keypoint Detection with Neural Networks&nbsp;
        </h1>
        <h4 class="u-text u-text-palette-3-base u-text-2">Sainan Chen<br>11/1/2020
        </h4>
        <nav class="u-menu u-menu-dropdown u-offcanvas u-menu-1">
          <div class="menu-collapse" style="font-size: 1rem; letter-spacing: 0;">
            <a class="u-active-palette-1-base u-button-style u-custom-left-right-menu-spacing u-custom-padding-bottom u-custom-top-bottom-menu-spacing u-nav-link u-text-active-white u-text-hover-palette-3-base u-text-palette-1-base" href="#">
              <svg><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#menu-hamburger"></use></svg>
              <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><symbol id="menu-hamburger" viewBox="0 0 16 16" style="width: 16px; height: 16px;"><rect y="1" width="16" height="2"></rect><rect y="7" width="16" height="2"></rect><rect y="13" width="16" height="2"></rect>
</symbol>
</defs></svg>
            </a>
          </div>
          <div class="u-custom-menu u-nav-container">
            <ul class="u-nav u-unstyled u-nav-1"><li class="u-nav-item"><a class="u-active-palette-1-base u-button-style u-nav-link u-text-active-white u-text-hover-palette-3-base u-text-palette-1-base" href="Introduction.html" style="padding: 10px 36px;">Introduction</a>
</li><li class="u-nav-item"><a class="u-active-palette-1-base u-button-style u-nav-link u-text-active-white u-text-hover-palette-3-base u-text-palette-1-base" href="1-Nose-Tip-Detection.html" style="padding: 10px 36px;">1 Nose Tip Detection</a>
</li><li class="u-nav-item"><a class="u-active-palette-1-base u-button-style u-nav-link u-text-active-white u-text-hover-palette-3-base u-text-palette-1-base" href="2-Full-Facial.html" style="padding: 10px 36px;">2 Full Facial Keypoints Detection</a>
</li><li class="u-nav-item"><a class="u-active-palette-1-base u-button-style u-nav-link u-text-active-white u-text-hover-palette-3-base u-text-palette-1-base" href="3-Train-With-Larger-Dataset.html" style="padding: 10px 36px;">3 Train With Larger Dataset</a>
</li><li class="u-nav-item"><a class="u-active-palette-1-base u-button-style u-nav-link u-text-active-white u-text-hover-palette-3-base u-text-palette-1-base" href="Conclusion.html" style="padding: 10px 36px;">Conclusion</a>
</li></ul>
          </div>
          <div class="u-custom-menu u-nav-container-collapse">
            <div class="u-black u-container-style u-inner-container-layout u-opacity u-opacity-95 u-sidenav">
              <div class="u-menu-close"></div>
              <ul class="u-align-center u-nav u-popupmenu-items u-unstyled u-nav-2"><li class="u-nav-item"><a class="u-button-style u-nav-link" href="Introduction.html" style="padding: 10px 36px;">Introduction</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link" href="1-Nose-Tip-Detection.html" style="padding: 10px 36px;">1 Nose Tip Detection</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link" href="2-Full-Facial.html" style="padding: 10px 36px;">2 Full Facial Keypoints Detection</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link" href="3-Train-With-Larger-Dataset.html" style="padding: 10px 36px;">3 Train With Larger Dataset</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link" href="Conclusion.html" style="padding: 10px 36px;">Conclusion</a>
</li></ul>
            </div>
            <div class="u-black u-menu-overlay u-opacity u-opacity-70"></div>
          </div>
        </nav>
      </div></header>
    <section class="u-clearfix u-section-1" id="sec-9694">
      <div class="u-clearfix u-sheet u-sheet-1">
        <h2 class="u-text u-text-default u-text-palette-3-base u-text-1">Dataset</h2>
        <p class="u-text u-text-2">We use the same dataset as the one for last part. However, now we go one step further and we are trying to predict all 58 keypoints using CNN model!</p>
        <h2 class="u-text u-text-default u-text-palette-3-base u-text-3">Dataloader</h2>
        <p class="u-text u-text-4">Now we resize images in datasets to size&nbsp; 240*180 instead of 80*60 to capture more information. One another important improvement is <b>augmentation</b> on both training data and validation data. Because we have relatively small dataset (only 240 images), we try to increase our dataset size by having <b>rotation</b>, <b>shift</b>, <b>brightness change</b>, <b>contrast change</b> or <b>hue change</b> on original images to create new images. Here I implemented random shift with offset&lt;=30 pixels in both x and y directions and random rotation of &lt;=20 degrees in any direction around the center. Pay attention that the ground truth point should also be transformed! Here I increase the dataset size by 10 times.&nbsp;
        </p>
        <div class="u-gallery u-layout-grid u-lightbox u-show-text-on-hover u-gallery-1">
          <div class="u-gallery-inner u-gallery-inner-1">
            <div class="u-effect-fade u-gallery-item">
              <div class="u-back-slide">
                <img class="u-back-image u-expanded" src="images/ScreenShot2020-11-01at1.51.54AM.png">
              </div>
              <div class="u-over-slide u-shading u-over-slide-1">
                <h3 class="u-gallery-heading"></h3>
                <p class="u-gallery-text"></p>
              </div>
            </div>
            <div class="u-effect-fade u-gallery-item">
              <div class="u-back-slide">
                <img class="u-back-image u-expanded" src="images/ScreenShot2020-11-01at1.51.36AM.png">
              </div>
              <div class="u-over-slide u-shading u-over-slide-2">
                <h3 class="u-gallery-heading"></h3>
                <p class="u-gallery-text"></p>
              </div>
            </div>
            <div class="u-effect-fade u-gallery-item">
              <div class="u-back-slide">
                <img class="u-back-image u-expanded" src="images/ScreenShot2020-11-01at1.49.51AM.png">
              </div>
              <div class="u-over-slide u-shading u-over-slide-3">
                <h3 class="u-gallery-heading"></h3>
                <p class="u-gallery-text"></p>
              </div>
            </div>
          </div>
        </div>
        <h2 class="u-text u-text-default u-text-palette-3-base u-text-5">CNN Model</h2>
        <p class="u-text u-text-6">The new CNN model has input size 240*180, output size 116 (coordinates of 58 key points), and there are more layers in the middle: conv2 with kernal size 3*3, RELU, maxPool with window 2*2.&nbsp;<br>
        </p>
        <img src="images/net2.jpg" alt="" class="u-image u-image-default u-image-1">
        <p class="u-text u-text-default u-text-7">We can visualize the convolution kernels.</p>
        <div class="u-clearfix u-expanded-width u-layout-wrap u-layout-wrap-1">
          <div class="u-layout">
            <div class="u-layout-row">
              <div class="u-container-style u-layout-cell u-left-cell u-size-30 u-layout-cell-1">
                <div class="u-container-layout u-container-layout-1">
                  <img src="images/ScreenShot2020-10-31at9.19.57PM.png" alt="" class="u-image u-image-default u-image-2" data-image-width="868" data-image-height="148">
                  <p class="u-text u-text-default u-text-8">kernels for first conv2 layer</p>
                </div>
              </div>
              <div class="u-container-style u-layout-cell u-right-cell u-size-30 u-layout-cell-2">
                <div class="u-container-layout u-container-layout-2">
                  <img src="images/ScreenShot2020-10-31at9.26.31PM.png" alt="" class="u-image u-image-default u-image-3" data-image-width="1694" data-image-height="850">
                  <p class="u-text u-text-default u-text-9">kernels for second conv2 layer</p>
                </div>
              </div>
            </div>
          </div>
        </div>
        <p class="u-text u-text-10">Then I train the model on training data using 20 epoches. During the training process, we can see the MSE loss of the model on training dataset and validation dataset are decreasing, which means our model is gradually improved with more training epoches.</p>
        <img src="images/2loss.png" alt="" class="u-image u-image-default u-image-4">
        <h2 class="u-text u-text-default u-text-palette-3-base u-text-11">Result</h2>
        <p class="u-text u-text-12">After the training process, I apply the model onto training data and validation data again. Following are some examples showing how well the simple model does on predicting the key points.&nbsp; Blue points indicate the ground truth key points, and red points indicate the points predicted by my model.</p>
        <div class="u-gallery u-layout-grid u-lightbox u-show-text-on-hover u-gallery-2">
          <div class="u-gallery-inner u-gallery-inner-2">
            <div class="u-effect-fade u-gallery-item">
              <div class="u-back-slide">
                <img class="u-back-image u-expanded" src="images/11.jpg">
              </div>
              <div class="u-over-slide u-shading u-over-slide-4">
                <h3 class="u-gallery-heading"></h3>
                <p class="u-gallery-text"></p>
              </div>
            </div>
            <div class="u-effect-fade u-gallery-item">
              <div class="u-back-slide">
                <img class="u-back-image u-expanded" src="images/29.jpg">
              </div>
              <div class="u-over-slide u-shading u-over-slide-5">
                <h3 class="u-gallery-heading"></h3>
                <p class="u-gallery-text"></p>
              </div>
            </div>
            <div class="u-effect-fade u-gallery-item">
              <div class="u-back-slide">
                <img class="u-back-image u-expanded" src="images/110.jpg">
              </div>
              <div class="u-over-slide u-shading u-over-slide-6">
                <h3 class="u-gallery-heading"></h3>
                <p class="u-gallery-text"></p>
              </div>
            </div>
          </div>
        </div>
        <p class="u-text u-text-13">Same as before, the model predicts well on those images which are taken fight in front of&nbsp; the person's face. Although the prediction may not be as accurate as predicting a single nose tip point, the error is reasonable.</p>
        <div class="u-gallery u-layout-grid u-lightbox u-show-text-on-hover u-gallery-3">
          <div class="u-gallery-inner u-gallery-inner-3">
            <div class="u-effect-fade u-gallery-item">
              <div class="u-back-slide">
                <img class="u-back-image u-expanded" src="images/12.jpg">
              </div>
              <div class="u-over-slide u-shading u-over-slide-7">
                <h3 class="u-gallery-heading"></h3>
                <p class="u-gallery-text"></p>
              </div>
            </div>
            <div class="u-effect-fade u-gallery-item">
              <div class="u-back-slide">
                <img class="u-back-image u-expanded" src="images/91.jpg">
              </div>
              <div class="u-over-slide u-shading u-over-slide-8">
                <h3 class="u-gallery-heading"></h3>
                <p class="u-gallery-text"></p>
              </div>
            </div>
            <div class="u-effect-fade u-gallery-item">
              <div class="u-back-slide">
                <img class="u-back-image u-expanded" src="images/109.jpg">
              </div>
              <div class="u-over-slide u-shading u-over-slide-9">
                <h3 class="u-gallery-heading"></h3>
                <p class="u-gallery-text"></p>
              </div>
            </div>
          </div>
        </div>
        <p class="u-text u-text-14">These three predictions, however, are not as good as the examples above. We can see the points on jaw are off a little bit far. Same as before, it might be caused by the unpreviliged photo angle.</p>
      </div>
    </section>
    
    
    <footer class="u-align-center u-clearfix u-footer u-grey-80 u-footer" id="sec-b697"><div class="u-clearfix u-sheet u-sheet-1">
        <p class="u-small-text u-text u-text-variant u-text-1">Sainan Chen</p>
      </div></footer>
    <section class="u-backlink u-clearfix u-grey-80">
      <a class="u-link" href="https://nicepage.com/website-templates" target="_blank">
        <span>Website Templates</span>
      </a>
      <p class="u-text">
        <span>created with</span>
      </p>
      <a class="u-link" href="https://nicepage.com/" target="_blank">
        <span>Website Builder Software</span>
      </a>. 
    </section>
  </body>
</html>